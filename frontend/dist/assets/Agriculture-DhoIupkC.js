import{r as s,d as _,j as e,f as y}from"./index-yVhfAtPc.js";import{C as n,a as d,b as c,c as o,d as m}from"./card-fvSyAV1p.js";import{I as v}from"./input-BRuGLdy_.js";const z=()=>{const[g,f]=s.useState({}),[a,k]=s.useState("番茄"),[h,S]=s.useState(1),[b,F]=s.useState("最大化产量"),[r,N]=s.useState({temperature:25,humidity:60,co2:400}),[l,D]=s.useState(null),[j,P]=s.useState(null),[p,I]=s.useState(null);s.useEffect(()=>{O()},[]);const[G,w]=s.useState(!1),[M,C]=s.useState(null),O=async()=>{w(!0),C(null);try{const t=await _.getCropConfigs();t.success&&Object.keys(t.data).length>0?f(t.data):(f({番茄:{crop_name:"番茄",growth_stages:[{stage_name:"发芽期",duration_days:7,optimal_temperature:[20,25],optimal_humidity:[70,80],light_hours:12},{stage_name:"幼苗期",duration_days:21,optimal_temperature:[18,22],optimal_humidity:[60,70],light_hours:14},{stage_name:"生长期",duration_days:28,optimal_temperature:[20,25],optimal_humidity:[65,75],light_hours:16},{stage_name:"结果期",duration_days:35,optimal_temperature:[22,28],optimal_humidity:[70,80],light_hours:18}],target_yield:"5kg/m²",quality_metrics:{甜度:8.5,硬度:7.2,色泽:9}},黄瓜:{crop_name:"黄瓜",growth_stages:[{stage_name:"发芽期",duration_days:5,optimal_temperature:[25,30],optimal_humidity:[75,85],light_hours:12},{stage_name:"幼苗期",duration_days:15,optimal_temperature:[20,25],optimal_humidity:[65,75],light_hours:14},{stage_name:"生长期",duration_days:20,optimal_temperature:[25,30],optimal_humidity:[70,80],light_hours:16},{stage_name:"结果期",duration_days:30,optimal_temperature:[25,32],optimal_humidity:[75,85],light_hours:18}],target_yield:"8kg/m²",quality_metrics:{长度:15,直径:3,色泽:8.5}}}),C("使用默认作物数据"))}catch(t){console.error("加载作物配置失败:",t),f({番茄:{crop_name:"番茄",growth_stages:[{stage_name:"发芽期",duration_days:7,optimal_temperature:[20,25],optimal_humidity:[70,80],light_hours:12},{stage_name:"幼苗期",duration_days:21,optimal_temperature:[18,22],optimal_humidity:[60,70],light_hours:14},{stage_name:"生长期",duration_days:28,optimal_temperature:[20,25],optimal_humidity:[65,75],light_hours:16},{stage_name:"结果期",duration_days:35,optimal_temperature:[22,28],optimal_humidity:[70,80],light_hours:18}],target_yield:"5kg/m²",quality_metrics:{甜度:8.5,硬度:7.2,色泽:9}},黄瓜:{crop_name:"黄瓜",growth_stages:[{stage_name:"发芽期",duration_days:5,optimal_temperature:[25,30],optimal_humidity:[75,85],light_hours:12},{stage_name:"幼苗期",duration_days:15,optimal_temperature:[20,25],optimal_humidity:[65,75],light_hours:14},{stage_name:"生长期",duration_days:20,optimal_temperature:[25,30],optimal_humidity:[70,80],light_hours:16},{stage_name:"结果期",duration_days:30,optimal_temperature:[25,32],optimal_humidity:[75,85],light_hours:18}],target_yield:"8kg/m²",quality_metrics:{长度:15,直径:3,色泽:8.5}}}),C("加载失败，使用默认作物数据")}finally{w(!1)}},E=async()=>{try{const t=await _.generateLightRecipe({crop_type:a,current_day:h,target_objective:b,environment:r});t.success&&D(t.data.recipe)}catch(t){console.error("生成光配方失败:",t)}},A=async()=>{try{const t=Array.from({length:800},(x,u)=>Math.random()*.1+Math.exp(-Math.pow(u-380,2)/1e3)*.5),i=await _.predictGrowth({crop_type:a,current_day:h,environmental_data:r,spectrum_data:t});i.success&&P(i.data)}catch(t){console.error("预测生长状态失败:",t)}},R=async()=>{try{const t=await _.createPlantingPlan({crop_type:a,target_yield:b,start_date:new Date().toISOString().split("T")[0],expected_harvest_date:new Date(Date.now()+7776e6).toISOString().split("T")[0]});t.success&&I(t.data)}catch(t){console.error("创建种植计划失败:",t)}},q=async()=>{try{const t=await _.contributeAgricultureData({user_id:"user_001",crop_type:a,growth_data:{day:h,environment:r,recipe:l}});t.success&&alert(`数据贡献成功！获得 ${t.data.photon_points_earned} 光子积分`)}catch(t){console.error("数据贡献失败:",t)}};return e.jsx("div",{className:"container mx-auto p-6 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"作物选择与规划"}),e.jsx(o,{children:"选择作物类型并制定种植计划"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-card-foreground",children:"选择作物"}),e.jsx("select",{className:"w-full p-2 border rounded bg-black text-white",value:a,onChange:t=>k(t.target.value),children:Object.keys(g).map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-card-foreground",children:"生长天数"}),e.jsx(v,{type:"number",value:h,onChange:t=>S(parseInt(t.target.value)),min:"1",max:"365"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-card-foreground",children:"种植目标"}),e.jsxs("select",{className:"w-full p-2 border rounded bg-black text-white",value:b,onChange:t=>F(t.target.value),children:[e.jsx("option",{value:"最大化产量",children:"最大化产量"}),e.jsx("option",{value:"提升甜度",children:"提升甜度"}),e.jsx("option",{value:"提升抗性",children:"提升抗性"})]})]}),e.jsx(y,{onClick:R,className:"w-full",children:"制定种植计划"})]})]}),e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"环境参数"}),e.jsx(o,{children:"设置当前环境条件"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-card-foreground",children:"温度 (°C)"}),e.jsx(v,{type:"number",value:r.temperature,onChange:t=>N({...r,temperature:parseFloat(t.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-card-foreground",children:"湿度 (%)"}),e.jsx(v,{type:"number",value:r.humidity,onChange:t=>N({...r,humidity:parseFloat(t.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-card-foreground",children:"CO2浓度 (ppm)"}),e.jsx(v,{type:"number",value:r.co2,onChange:t=>N({...r,co2:parseFloat(t.target.value)})})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"光配方系统"}),e.jsx(o,{children:"AI生成最优光配方"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsx(y,{onClick:E,className:"w-full",children:"生成光配方"}),l&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"光配方详情："}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:["380nm紫外线: ",(l.uv_380nm*100).toFixed(1),"%"]}),e.jsxs("div",{children:["720nm远红外: ",(l.far_red_720nm*100).toFixed(1),"%"]}),e.jsxs("div",{children:["白光: ",(l.white_light*100).toFixed(1),"%"]}),e.jsxs("div",{children:["660nm红光: ",(l.red_660nm*100).toFixed(1),"%"]}),e.jsxs("div",{className:"col-span-2",children:["白红配比: ",l.white_red_ratio.toFixed(1),":1"]})]})]})]})]}),e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"生长预测"}),e.jsx(o,{children:"AI预测植物生长状态"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsx(y,{onClick:A,className:"w-full",children:"预测生长状态"}),j&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"生长状态预测："}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[(j.growth_rate*100).toFixed(0),"%"]}),e.jsx("div",{children:"生长率"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[(j.health_score*100).toFixed(0),"%"]}),e.jsx("div",{children:"健康度"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[(j.yield_potential*100).toFixed(0),"%"]}),e.jsx("div",{children:"产量潜力"})]})]})]})]})]}),e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"数据贡献"}),e.jsx(o,{children:"贡献数据获得光子积分"})]}),e.jsx(m,{children:e.jsx(y,{onClick:q,className:"w-full",variant:"outline",children:"贡献当前数据"})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"种植计划"}),e.jsx(o,{children:"详细的种植时间表"})]}),e.jsx(m,{children:p?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"作物类型:"}),e.jsx("span",{className:"font-semibold",children:p.crop_type})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"总天数:"}),e.jsxs("span",{className:"font-semibold",children:[p.total_days,"天"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"目标产量:"}),e.jsx("span",{className:"font-semibold",children:p.target_yield})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"生长阶段计划："}),e.jsx("div",{className:"space-y-2",children:(p.planting_plan||[]).map((t,i)=>e.jsxs("div",{className:"p-2 border rounded",children:[e.jsx("div",{className:"font-medium",children:t.stage}),e.jsxs("div",{className:"text-sm text-gray-600",children:["第",t.start_day,"-",t.end_day,"天 | 光照: ",t.light_hours,"小时 | 温度: ",t.temperature_range[0],"-",t.temperature_range[1],"°C"]})]},i))})]})]}):e.jsx("p",{className:"text-gray-500 text-center",children:"请先制定种植计划"})})]}),e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"当前生长阶段"}),e.jsx(o,{children:"基于选择的作物和生长天数"})]}),e.jsx(m,{children:a&&g[a]&&e.jsx("div",{className:"space-y-2",children:(g[a].growth_stages||[]).map((t,i)=>{const x=g[a].growth_stages.slice(0,i).reduce((L,T)=>L+T.duration_days,0),u=h>x&&h<=x+t.duration_days;return e.jsxs("div",{className:`p-2 border rounded ${u?"bg-black border-gray-700":""}`,children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:`font-medium ${u?"text-white":""}`,children:[t.stage_name,u&&e.jsx("span",{className:"ml-2 text-xs bg-gray-700 text-white px-2 py-1 rounded",children:"当前"})]}),e.jsxs("span",{className:"text-sm text-gray-300",children:["第",x+1,"-",x+t.duration_days,"天"]})]}),u&&e.jsxs("div",{className:"mt-1 text-sm text-gray-300",children:["光照: ",t.light_hours,"小时 | 温度: ",t.optimal_temperature[0],"-",t.optimal_temperature[1],"°C | 湿度: ",t.optimal_humidity[0],"%-",t.optimal_humidity[1],"%"]})]},i)})})})]})]})]})})};export{z as default};
//# sourceMappingURL=Agriculture-DhoIupkC.js.map
