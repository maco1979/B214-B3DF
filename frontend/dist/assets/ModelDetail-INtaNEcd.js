import{c as L,l as B,u as H,r as c,j as e,f as r,d as f}from"./index-yVhfAtPc.js";import{C as d,a as x,b as m,c as h,d as o}from"./card-fvSyAV1p.js";import{a as R,b as A,T as O}from"./useModelsQuery-DiSZHrR2.js";import{C as U,P as q}from"./pen-square-BuDBM4GE.js";import{P as Q}from"./play-DJ2Vx5IY.js";import{P as G}from"./pause-Bajt5Amz.js";import{S as K}from"./share-2-Yeqrpp_p.js";import"./useQuery-BqIxVbD1.js";const J=L("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),W=L("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);function ie(){const{id:w}=B(),p=H(),n=w?decodeURIComponent(w):"",{data:t,isLoading:F,refetch:b}=R(n),[g,v]=c.useState(!1),[l,S]=c.useState(null),[u,y]=c.useState(null),[j,C]=c.useState(null),{data:i=[],isLoading:T,refetch:M}=A(n),[V,_]=c.useState(""),[$,D]=c.useState(!1),z=async()=>{if(!(!t||!n))try{v(!0),y(null);const s=await f.startModelTraining(n,{dataset:"default-dataset",epochs:100,batch_size:32});if(s.success&&s.data){const{task_id:a}=s.data;S(s.data);const N=setInterval(()=>{P(a)},2e3);C(N)}else y(s.error||"训练启动失败")}catch(s){y("训练启动失败: "+s.message)}finally{v(!1)}},P=async s=>{try{const a=await f.getModelTrainingStatus(s);a.success&&a.data&&(S(a.data),(a.data.status==="completed"||a.data.status==="failed")&&(j&&(clearInterval(j),C(null)),b()))}catch(a){console.error("获取训练状态失败:",a)}},k=async s=>{_(s),D(!1);const a=i.find(N=>N.version===s);a&&p(`/models/${encodeURIComponent(a.id)}`)},E=async()=>{if(!(!t||!n))try{const s=await f.createModelVersion(n,{name:t.name});s.success&&s.data&&(await M(),p(`/models/${s.data.id}`))}catch(s){console.error("创建新版本失败:",s)}};c.useEffect(()=>{t&&i&&i.length>0&&_(t.version)},[t,i]),c.useEffect(()=>()=>{j&&clearInterval(j)},[j]);const Z=[{id:"1",start_time:"2025-12-24T10:00:00Z",end_time:"2025-12-24T12:30:00Z",status:"completed",accuracy:.982,loss:.056},{id:"2",start_time:"2025-12-23T15:45:00Z",end_time:"2025-12-23T18:20:00Z",status:"completed",accuracy:.975,loss:.068},{id:"3",start_time:"2025-12-22T09:15:00Z",end_time:"2025-12-22T11:45:00Z",status:"error",accuracy:.921,loss:.189}];if(F)return e.jsx("div",{className:"flex justify-center items-center h-96",children:e.jsx("div",{className:"text-tech-primary text-xl",children:"加载中..."})});if(!t)return e.jsxs("div",{className:"flex flex-col justify-center items-center h-96 space-y-4",children:[e.jsx("div",{className:"text-red-400 text-xl",children:"加载失败"}),e.jsx(r,{variant:"tech",onClick:()=>b(),children:"重试"})]});const I=s=>s?s<1024?`${s} B`:s<1024*1024?`${(s/1024).toFixed(1)} KB`:s<1024*1024*1024?`${(s/(1024*1024)).toFixed(1)} MB`:`${(s/(1024*1024*1024)).toFixed(1)} GB`:"--";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>p("/models"),children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"返回列表"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold gradient-text mb-2",children:t.name}),e.jsxs("p",{className:"text-gray-300",children:["模型详情 - 版本 ",t.version]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(r,{variant:"outline",size:"sm",className:"flex items-center space-x-1",onClick:()=>D(!$),children:[e.jsx("span",{children:"选择版本"}),e.jsx(U,{className:"w-4 h-4"})]}),$&&e.jsx("div",{className:"absolute mt-2 w-48 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-10",children:T?e.jsx("div",{className:"p-2 text-gray-400",children:"加载中..."}):i.length>0?i.map(s=>e.jsxs("button",{className:`w-full text-left px-4 py-2 text-sm ${s.version===V?"bg-gray-700 text-white":"text-gray-300 hover:bg-gray-700"}`,onClick:()=>k(s.version),children:["版本 ",s.version," - ",s.status]},s.id)):e.jsx("div",{className:"p-2 text-gray-400",children:"暂无版本历史"})})]}),e.jsxs(r,{variant:"outline",className:"flex items-center space-x-2",onClick:E,children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{children:"创建版本"})]}),e.jsxs(r,{variant:"tech",className:"flex items-center space-x-2",onClick:z,disabled:g||(t==null?void 0:t.status)==="training",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:g?"启动中...":"开始训练"})]}),e.jsxs(r,{variant:"outline",className:"flex items-center space-x-2",disabled:!g&&t.status!=="training",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{children:"暂停"})]}),e.jsxs(r,{variant:"outline",className:"flex items-center space-x-2",children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:"下载"})]}),e.jsxs(r,{variant:"outline",className:"flex items-center space-x-2",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:"分享"})]}),e.jsxs(r,{variant:"outline",className:"flex items-center space-x-2 text-red-400",children:[e.jsx(O,{className:"w-4 h-4"}),e.jsx("span",{children:"删除"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(d,{className:"glass-effect lg:col-span-2",children:[e.jsxs(x,{children:[e.jsx(m,{children:"模型信息"}),e.jsx(h,{children:"基本信息和配置"})]}),e.jsx(o,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"模型ID"}),e.jsx("p",{className:"text-white",children:t.id})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"创建时间"}),e.jsx("p",{className:"text-white",children:new Date(t.created_at).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"最后更新"}),e.jsx("p",{className:"text-white",children:new Date(t.updated_at).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"模型状态"}),e.jsx("p",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.status==="ready"?"bg-green-500 text-white":t.status==="training"?"bg-yellow-500 text-white":"bg-red-500 text-white"}`,children:t.status==="ready"?"运行中":t.status==="training"?"训练中":t.status==="deployed"?"已部署":"错误"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"模型大小"}),e.jsx("p",{className:"text-white",children:I(t.size)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"准确率"}),e.jsx("p",{className:"text-white",children:t.accuracy?`${(t.accuracy*100).toFixed(2)}%`:"--"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"模型描述"}),e.jsx("p",{className:"text-white",children:t.description})]})]})]})})]}),e.jsxs(d,{className:"glass-effect",children:[e.jsxs(x,{children:[e.jsx(m,{children:"性能指标"}),e.jsx(h,{children:"最新训练结果"})]}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-400",children:"准确率"}),e.jsx("span",{className:"text-sm font-medium text-white",children:t.accuracy?`${(t.accuracy*100).toFixed(2)}%`:"--"})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5",children:e.jsx("div",{className:"bg-gradient-to-r from-green-400 to-blue-500 h-2.5 rounded-full",style:{width:`${t.accuracy?t.accuracy*100:0}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs text-gray-500 mb-1",children:"精确率"}),e.jsx("p",{className:"text-xl font-bold text-white",children:"98.5%"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs text-gray-500 mb-1",children:"召回率"}),e.jsx("p",{className:"text-xl font-bold text-white",children:"97.8%"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs text-gray-500 mb-1",children:"F1分数"}),e.jsx("p",{className:"text-xl font-bold text-white",children:"98.1%"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs text-gray-500 mb-1",children:"训练时间"}),e.jsx("p",{className:"text-xl font-bold text-white",children:"2.5h"})]})]})]})})]})]}),(l||u)&&e.jsxs(d,{className:"glass-effect",children:[e.jsxs(x,{children:[e.jsx(m,{children:"训练状态"}),e.jsx(h,{children:"实时训练进度"})]}),e.jsx(o,{children:u?e.jsx("div",{className:"text-red-400",children:e.jsxs("p",{children:["训练失败: ",u]})}):l?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"训练进度"}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-4",children:e.jsx("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 h-4 rounded-full transition-all duration-300 ease-in-out",style:{width:`${l.progress}%`}})}),e.jsxs("div",{className:"flex justify-between mt-1 text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"当前阶段"}),e.jsx("span",{className:"text-white font-medium",children:l.stage})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"训练任务ID"}),e.jsx("p",{className:"text-white font-mono text-sm truncate",children:l.task_id})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"当前步骤"}),e.jsxs("p",{className:"text-white",children:[l.current_step," / ",l.total_steps]})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"训练状态"}),e.jsx("p",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${l.status==="completed"?"bg-green-500 text-white":l.status==="training"?"bg-yellow-500 text-white":"bg-red-500 text-white"}`,children:l.status==="completed"?"已完成":l.status==="training"?"训练中":"失败"})]})]}),l.metrics&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"训练指标"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(l.metrics).map(([s,a])=>e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:s}),e.jsx("p",{className:"text-white",children:a.toFixed(4)})]},s))})]})]}):null})]}),e.jsxs(d,{className:"glass-effect",children:[e.jsxs(x,{children:[e.jsx(m,{children:"训练历史"}),e.jsx(h,{children:"模型训练记录"})]}),e.jsx(o,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-400",children:"训练ID"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-400",children:"开始时间"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-400",children:"结束时间"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-400",children:"状态"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-400",children:"准确率"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-400",children:"损失值"})]})}),e.jsx("tbody",{children:Z.map(s=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50",children:[e.jsx("td",{className:"py-3 px-4 text-sm text-white",children:s.id}),e.jsx("td",{className:"py-3 px-4 text-sm text-white",children:new Date(s.start_time).toLocaleString()}),e.jsx("td",{className:"py-3 px-4 text-sm text-white",children:s.end_time?new Date(s.end_time).toLocaleString():"-"}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s.status==="completed"?"bg-green-500 text-white":s.status==="running"?"bg-yellow-500 text-white":"bg-red-500 text-white"}`,children:s.status==="completed"?"完成":s.status==="running"?"运行中":"失败"})}),e.jsx("td",{className:"py-3 px-4 text-sm text-white",children:s.accuracy?`${(s.accuracy*100).toFixed(2)}%`:"-"}),e.jsx("td",{className:"py-3 px-4 text-sm text-white",children:s.loss?s.loss.toFixed(4):"-"})]},s.id))})]})})})]}),e.jsxs(d,{className:"glass-effect",children:[e.jsxs(x,{children:[e.jsx(m,{children:"版本历史"}),e.jsx(h,{children:"所有模型版本记录"})]}),e.jsx(o,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-400",children:"版本号"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-400",children:"模型ID"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-400",children:"创建时间"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-400",children:"状态"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-400",children:"准确率"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-400",children:"大小"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-400",children:"操作"})]})}),e.jsx("tbody",{children:T?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"py-6 text-center text-gray-400",children:"加载中..."})}):i.length>0?i.map(s=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50",children:[e.jsx("td",{className:"py-3 px-4 text-sm text-white",children:s.version}),e.jsx("td",{className:"py-3 px-4 text-sm text-white truncate max-w-xs",children:s.id}),e.jsx("td",{className:"py-3 px-4 text-sm text-white",children:new Date(s.created_at).toLocaleString()}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s.status==="ready"?"bg-green-500 text-white":s.status==="training"?"bg-yellow-500 text-white":"bg-red-500 text-white"}`,children:s.status==="ready"?"运行中":s.status==="training"?"训练中":s.status==="deployed"?"已部署":"错误"})}),e.jsx("td",{className:"py-3 px-4 text-sm text-white",children:s.accuracy?`${(s.accuracy*100).toFixed(2)}%`:"-"}),e.jsx("td",{className:"py-3 px-4 text-sm text-white",children:I(s.size)}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(r,{variant:"outline",size:"sm",className:"px-3",onClick:()=>k(s.version),children:"查看详情"})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"py-6 text-center text-gray-400",children:"暂无版本历史"})})})]})})})]}),e.jsxs(d,{className:"glass-effect",children:[e.jsxs(x,{children:[e.jsx(m,{children:"模型配置"}),e.jsx(h,{children:"超参数和技术规格"})]}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"超参数"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"学习率"}),e.jsx("p",{className:"text-white",children:"0.001"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"批次大小"}),e.jsx("p",{className:"text-white",children:"32"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"迭代次数"}),e.jsx("p",{className:"text-white",children:"100"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"激活函数"}),e.jsx("p",{className:"text-white",children:"ReLU"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"优化器"}),e.jsx("p",{className:"text-white",children:"Adam"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"正则化"}),e.jsx("p",{className:"text-white",children:"L2 (0.01)"})]})]})]})})})]})]})}export{ie as ModelDetail};
//# sourceMappingURL=ModelDetail-INtaNEcd.js.map
