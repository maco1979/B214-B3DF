import{c as S,r as x,j as e,a as j,B as v,A as I,m as k,Z as C,b as R,S as _,C as T,M as D,d as A,e as L}from"./index-yVhfAtPc.js";import{T as M,u as U}from"./useModelsQuery-DiSZHrR2.js";import{u as z,a as F,b as O}from"./useSystemQueries-4KvPkmo-.js";import{B as u}from"./BentoCard-BzO3UFIZ.js";import{R as $}from"./refresh-cw-a_RgfZ6I.js";import{P as G}from"./pause-Bajt5Amz.js";import{P}from"./play-DJ2Vx5IY.js";import{T as B}from"./trending-up-BWoRqqDA.js";import{R as V,A as Y,C as q,X as K,Y as Q,T as H,a as W,b as X}from"./AreaChart-B2uGTh-R.js";import{C as Z}from"./clock-A5PGEByJ.js";import{U as J}from"./users-DqIhfcId.js";import"./useQuery-BqIxVbD1.js";const ee=S("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),se=S("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);function te(){const[b,c]=x.useState([]),[n,p]=x.useState(!1),[a,m]=x.useState(null),l=x.useRef(null);x.useEffect(()=>{l.current&&(l.current.scrollTop=l.current.scrollHeight)},[b,n]);const o=async(t="agriculture")=>{p(!0),c(r=>[...r,{role:"system",content:`REQUESTING NEURAL INFERENCE [${t.toUpperCase()}]...`}]);try{const r=await A.makeDecision(t,{timestamp:new Date().toISOString(),sensor_data:"optimal"});if(r.success&&r.data){const i=r.data;m(i);const h=`Decision ID: ${i.decision_id}
Action: ${i.action}
Confidence: ${(i.confidence*100).toFixed(0)}%
Execution Time: ${i.execution_time.toFixed(2)}ms`,y=i.recommendations?i.recommendations.join(`
`):"No recommendations available";setTimeout(()=>{c(f=>[...f,{role:"ai",content:h,type:"reasoning"}]),setTimeout(()=>{c(f=>[...f,{role:"ai",content:y,type:"decision"}]),p(!1)},800)},1200)}else throw new Error(r.error||"Failed to reach neural core")}catch(r){c(i=>[...i,{role:"ai",content:`CRITICAL ERROR: ${r instanceof Error?r.message:String(r)}`}]),p(!1)}};x.useEffect(()=>{b.length===0&&c([{role:"ai",content:"NEURAL_AGENT_V4.2 [ONLINE] - READY FOR INPUT"}])},[]);const N=()=>{c([{role:"ai",content:"TERMINAL_LOGS_FLUSHED - STANDBY"}])};return e.jsxs("div",{className:"flex flex-col h-full bg-cyber-black/40 border border-white/5 rounded-2xl overflow-hidden group",children:[e.jsxs("div",{className:"h-14 px-6 flex items-center justify-between border-b border-white/5 bg-cyber-black/20 backdrop-blur-md shrink-0",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"relative",children:e.jsx("div",{className:j("w-8 h-8 rounded-lg bg-cyber-cyan/10 flex items-center justify-center transition-all duration-500",n&&"neon-glow-cyan scale-110"),children:e.jsx(v,{className:j("w-5 h-5 text-cyber-cyan",n&&"animate-pulse")})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-black text-white/90 uppercase tracking-tighter",children:"Neural Intelligence"}),e.jsx("p",{className:"text-[8px] text-gray-500 uppercase tracking-widest font-bold",children:"Autonomous Decision Support"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>o("agriculture"),disabled:n,className:"px-3 py-1.5 rounded-lg bg-white/5 border border-white/5 text-[10px] font-bold text-gray-400 hover:text-cyber-cyan hover:border-cyber-cyan/30 transition-all disabled:opacity-50",children:"AGRI_MOD"}),e.jsx("button",{onClick:()=>o("risk"),disabled:n,className:"px-3 py-1.5 rounded-lg bg-white/5 border border-white/5 text-[10px] font-bold text-gray-400 hover:text-cyber-purple hover:border-cyber-purple/30 transition-all disabled:opacity-50",children:"RISK_ANL"}),e.jsx("div",{className:"w-[1px] h-4 bg-white/10 mx-1"}),e.jsx("button",{onClick:N,className:"p-1.5 rounded-lg text-gray-600 hover:text-cyber-rose hover:bg-cyber-rose/10 transition-all",children:e.jsx(M,{size:14})})]})]}),e.jsxs("div",{ref:l,className:"flex-1 overflow-y-auto p-6 space-y-4 font-mono text-[11px] custom-scrollbar",children:[e.jsx(I,{initial:!1,children:b.map((t,r)=>e.jsx(k.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:j("flex flex-col",t.role==="system"?"items-end":"items-start"),children:e.jsxs("div",{className:j("max-w-[90%] p-3 rounded-xl border transition-all duration-300",t.role==="system"?"bg-cyber-cyan/5 text-cyber-cyan border-cyber-cyan/20":t.type==="decision"?"bg-cyber-emerald/10 text-cyber-emerald border-cyber-emerald/30 font-bold shadow-lg shadow-cyber-emerald/10":"bg-white/5 text-gray-400 border-white/5"),children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1.5 opacity-40 text-[9px] uppercase font-black",children:[t.role==="ai"?e.jsx(se,{size:10}):e.jsx(C,{size:10}),e.jsx("span",{children:t.role==="ai"?"NEURAL_AGENT_01":"UPLINK_SYSTEM"})]}),e.jsx("div",{className:"leading-relaxed whitespace-pre-wrap",children:typeof t.content=="string"?t.content:JSON.stringify(t.content)}),t.type==="decision"&&typeof a=="object"&&a!==null&&e.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},className:"mt-3 pt-3 border-t border-white/10 flex items-center justify-between text-[8px] font-bold uppercase text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(R,{size:10,className:"text-cyber-cyan"}),e.jsxs("span",{children:["Conf: ",((typeof a.confidence=="number"?a.confidence:0)*100).toFixed(1)+"%"]})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(_,{size:10,className:"text-cyber-purple"}),e.jsxs("span",{children:["Node: ",String(typeof a.node_name=="string"?a.node_name:"DCNN_V4")]})]})]}),e.jsx("span",{className:"text-[10px] text-cyber-cyan",children:"VERIFIED"})]})]})},r))}),n&&e.jsxs("div",{className:"flex items-center space-x-3 text-cyber-cyan",children:[e.jsx(ee,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest animate-pulse",children:"Running Neural Inference..."})]})]}),e.jsxs("div",{className:"h-14 px-4 bg-cyber-black/40 border-t border-white/5 flex items-center space-x-3",children:[e.jsxs("div",{className:"flex-1 bg-cyber-black/60 rounded-xl px-4 py-2 border border-white/5 flex items-center space-x-2",children:[e.jsx(T,{size:14,className:"text-cyber-cyan"}),e.jsx("span",{className:"text-[10px] text-gray-600 font-bold uppercase italic",children:n?"NEURAL_CORE_BUSY":"WAITING_FOR_UPLINK..."})]}),e.jsx("button",{className:"w-10 h-10 rounded-xl bg-cyber-cyan/10 flex items-center justify-center text-cyber-cyan border border-cyber-cyan/20 hover:bg-cyber-cyan hover:text-black transition-all",children:e.jsx(D,{size:18})})]})]})}const re=[{name:"00:00",value:400},{name:"04:00",value:300},{name:"08:00",value:600},{name:"12:00",value:800},{name:"16:00",value:500},{name:"20:00",value:900},{name:"23:59",value:700}];function ye(){const{data:b}=U(),{data:c,refetch:n,isFetching:p,error:a}=z(),{data:m,error:l}=F(),{data:o,isFetching:N,error:t}=O(),[r,i]=x.useState(!1),[h,y]=x.useState(!1);x.useEffect(()=>{(async()=>{var d;try{const w=await A.get("/api/ai-control/master-control/status");y(((d=w.data)==null?void 0:d.master_control_active)||!1)}catch(w){console.error("Failed to fetch master status",w),y(!1)}})()},[]);const f=async()=>{try{const s=!h;(await A.activateMasterControl(s)).success&&y(s)}catch(s){console.error("Failed to toggle master control",s)}},g=s=>{try{return s==null?"—":typeof s=="string"||typeof s=="number"||typeof s=="boolean"?String(s):"—"}catch{return"—"}},E=[{label:"活跃模型",value:g(Array.isArray(b)?b.length:void 0),icon:v,color:"text-cyber-cyan"},{label:"神经吞吐量",value:g(c==null?void 0:c.inference_requests),icon:C,color:"text-yellow-400"},{label:"边缘节点",value:g(Array.isArray(o)?o.length:void 0),icon:R,color:"text-cyber-emerald"},{label:"区块链高度",value:g(typeof m=="object"&&m!==null&&typeof m.latest_block=="object"&&m.latest_block!==null&&typeof m.latest_block.block_number=="number"?m.latest_block.block_number:void 0),icon:_,color:"text-cyber-purple"}];return a||l||t?e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 space-y-3",children:[e.jsx("div",{className:"text-red-400 text-lg",children:"数据加载失败"}),e.jsx("div",{className:"text-gray-400 text-sm",children:(a==null?void 0:a.message)||(l==null?void 0:l.message)||(t==null?void 0:t.message)}),e.jsx("button",{onClick:()=>{n()},className:"px-4 py-2 rounded-lg bg-cyber-cyan/20 text-cyber-cyan border border-cyber-cyan/30",children:"重试"})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-black tracking-tighter text-white mb-2 uppercase",children:["系统 ",e.jsx("span",{className:"text-cyber-cyan",children:"概览"})]}),e.jsx("p",{className:"text-gray-500 font-medium",children:"监控有机神经网络和自主边缘节点。"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>n(),className:"p-3 rounded-xl glass-morphism border border-white/5 hover:border-cyber-cyan/30 text-gray-400 hover:text-cyber-cyan transition-all",children:e.jsx($,{size:20,className:r||p||N?"animate-spin":""})}),e.jsxs("button",{onClick:f,className:`px-6 py-3 rounded-xl font-bold flex items-center space-x-2 transition-all ${h?"bg-cyber-rose/10 text-cyber-rose border border-cyber-rose/20":"bg-cyber-cyan/10 text-cyber-cyan border border-cyber-cyan/20 neon-glow-cyan"}`,children:[h?e.jsx(G,{size:18}):e.jsx(P,{size:18}),e.jsx("span",{children:h?"关闭AI核心":"启动AI核心"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:E.map((s,d)=>e.jsx(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:d*.1},children:e.jsx(u,{className:"h-32 flex flex-col justify-center",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-1",children:s.label}),e.jsx("h3",{className:"text-3xl font-black text-white",children:s.value})]}),e.jsx("div",{className:`p-3 rounded-xl bg-white/5 border border-white/10 ${s.color}`,children:e.jsx(s.icon,{size:24})})]})})},s.label))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 auto-rows-[450px]",children:[e.jsx(u,{className:"lg:col-span-8 overflow-hidden p-0 border-none",title:"神经智能代理",description:"自主决策支持",icon:v,children:e.jsx("div",{className:"h-full w-full bg-cyber-black/40",children:e.jsx(te,{})})}),e.jsxs(u,{className:"lg:col-span-4",title:"遥测数据",description:"实时性能",icon:B,children:[e.jsx("div",{className:"h-64 w-full mt-4",children:e.jsx(V,{width:"100%",height:"100%",children:e.jsxs(Y,{data:re,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorValue",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#00f2ff",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#00f2ff",stopOpacity:0})]})}),e.jsx(q,{strokeDasharray:"3 3",stroke:"#ffffff05",vertical:!1}),e.jsx(K,{dataKey:"name",stroke:"#ffffff20",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(Q,{hide:!0}),e.jsx(H,{contentStyle:{backgroundColor:"#09090b",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px"},itemStyle:{color:"#00f2ff"}}),e.jsx(W,{type:"monotone",dataKey:"value",stroke:"#00f2ff",strokeWidth:2,fillOpacity:1,fill:"url(#colorValue)"})]})})}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 rounded-xl bg-white/5 border border-white/5",children:[e.jsx("span",{className:"text-sm text-gray-400 font-medium",children:"神经延迟"}),e.jsx("span",{className:"text-cyber-cyan font-bold",children:"14ms"})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 rounded-xl bg-white/5 border border-white/5",children:[e.jsx("span",{className:"text-sm text-gray-400 font-medium",children:"内存饱和度"}),e.jsx("span",{className:"text-cyber-purple font-bold",children:"42.8%"})]})]})]}),e.jsx(u,{className:"lg:col-span-4",title:"系统日志",description:"事件时间线",icon:Z,children:e.jsx("div",{className:"mt-4 space-y-4",children:[1,2,3,4].map((s,d)=>e.jsxs("div",{className:"flex items-start space-x-4 p-3 rounded-xl hover:bg-white/5 transition-colors border border-transparent hover:border-white/5 group",children:[e.jsx("div",{className:"w-1 h-8 rounded-full bg-cyber-cyan/40 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-sm font-bold text-white/90",children:"模型推理成功"}),e.jsx("span",{className:"text-[10px] text-gray-500",children:"2分钟前"})]}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:"DCNN-V3在Edge_Node_04上执行"})]}),e.jsx(X,{size:14,className:"text-gray-600 group-hover:text-cyber-cyan"})]},d))})}),e.jsx(u,{className:"lg:col-span-8",title:"边缘网络",description:"全局设备矩阵",icon:J,children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4",children:[(Array.isArray(o)?o:[]).slice(0,8).map(s=>{try{return e.jsxs("div",{className:"p-4 rounded-xl bg-white/5 border border-white/5 hover:border-cyber-cyan/30 transition-all text-center group",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-cyber-cyan/10 flex items-center justify-center mx-auto mb-3 group-hover:neon-glow-cyan transition-all",children:e.jsx(L,{size:18,className:"text-cyber-cyan"})}),e.jsx("p",{className:"text-xs font-bold text-white truncate",children:typeof(s==null?void 0:s.name)=="string"?s.name:"Unknown Device"}),e.jsx("p",{className:"text-[10px] text-cyber-emerald uppercase tracking-tighter",children:"已连接"})]},typeof(s==null?void 0:s.id)=="number"?s.id:Math.random().toString(36).substr(2,9))}catch{return e.jsx("div",{className:"p-4 rounded-xl bg-white/5 border border-white/5 text-center",children:e.jsx("p",{className:"text-xs font-bold text-gray-500",children:"Device Error"})},`error-${Math.random().toString(36).substr(2,9)}`)}}),(!Array.isArray(o)||o.length===0)&&[1,2,3,4,5,6,7,8].map(s=>e.jsxs("div",{className:"p-4 rounded-xl bg-white/5 border border-white/5 animate-pulse",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-white/5 mx-auto mb-3"}),e.jsx("div",{className:"h-2 w-12 bg-white/5 mx-auto rounded mb-2"}),e.jsx("div",{className:"h-1.5 w-8 bg-white/5 mx-auto rounded"})]},s))]})})]})]})}export{ye as Dashboard};
//# sourceMappingURL=Dashboard-CWycaJws.js.map
